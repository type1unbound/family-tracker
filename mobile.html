<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Compass Mobile</title>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f9fafb;
            overflow-x: hidden;
            touch-action: pan-y;
        }

        /* Top Navigation Bar - Sticky */
        .mobile-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 12px 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .app-logo {
            width: 32px;
            height: 32px;
            flex-shrink: 0;
        }

        .member-selector {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 12px;
            background: #f9fafb;
            border-radius: 12px;
            border: 2px solid #e5e7eb;
        }

        .member-avatar {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            overflow: hidden;
        }

        .member-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .member-name {
            font-size: 14px;
            font-weight: 600;
            color: #111827;
        }

        .dropdown-icon {
            margin-left: auto;
            font-size: 12px;
            color: #6b7280;
        }

        /* Member Dropdown */
        .member-dropdown {
            position: fixed;
            top: 70px;
            left: 16px;
            right: 16px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            z-index: 999;
            display: none;
            padding: 8px;
        }

        .member-dropdown.active {
            display: block;
            animation: slideDown 0.2s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .member-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .member-option:hover {
            background: #f9fafb;
        }

        .member-option.active {
            background: #f0f9ff;
            border: 2px solid #6366f1;
        }

        /* Main Content Area */
        .mobile-content {
            margin-top: 70px;
            margin-bottom: 80px;
            padding: 16px;
            min-height: calc(100vh - 150px);
        }

        .routine-view {
            transition: opacity 0.3s ease;
        }

        /* Stats Cards - Swipeable */
        .stats-swipe-container {
            position: relative;
            overflow: hidden;
            margin: 0 -16px 16px -16px;
            padding: 0 16px;
        }

        .stats-track {
            display: flex;
            gap: 16px;
            transition: transform 0.3s ease;
            padding: 8px 0;
        }

        .stat-card {
            min-width: calc(100% - 32px);
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        .stat-label {
            font-size: 13px;
            opacity: 0.9;
            margin-bottom: 8px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-size: 48px;
            font-weight: 800;
            line-height: 1;
            margin-bottom: 8px;
        }

        .stat-subtext {
            font-size: 13px;
            opacity: 0.9;
            font-weight: 500;
        }

        .stat-indicators {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-top: 12px;
        }

        .stat-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.4);
            transition: all 0.3s;
        }

        .stat-dot.active {
            width: 24px;
            border-radius: 4px;
            background: white;
        }

        /* Current Task Card */
        .current-task-card {
            background: white;
            border-radius: 20px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            margin-bottom: 16px;
            border: 3px solid #6366f1;
        }

        .task-time {
            font-size: 14px;
            color: #6366f1;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .task-name {
            font-size: 24px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 16px;
        }

        .task-checklist {
            list-style: none;
            margin-bottom: 20px;
        }

        .task-checklist li {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 12px;
            margin-bottom: 8px;
            font-size: 14px;
            color: #374151;
        }

        .task-checklist li::before {
            content: 'â€¢';
            color: #6366f1;
            font-size: 20px;
            font-weight: bold;
        }

        .complete-task-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #6366f1, #8b5cf6);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
            transition: transform 0.2s;
        }

        .complete-task-btn:active {
            transform: scale(0.98);
        }

        .complete-task-btn.completed {
            background: linear-gradient(135deg, #10b981, #059669);
        }

        /* Progress indicator */
        .progress-ring {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .progress-circle {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: conic-gradient(#6366f1 0deg, #e5e7eb 0deg);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .progress-inner {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 700;
            color: #6366f1;
        }

        /* Swipeable Task Container */
        .swipe-container {
            position: relative;
            overflow: hidden;
            margin: 0 -16px;
            padding: 0 16px;
        }

        .tasks-track {
            display: flex;
            gap: 16px;
            transition: transform 0.3s ease;
            padding: 8px 0;
        }

        .task-preview {
            min-width: 280px;
            background: white;
            border-radius: 16px;
            padding: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            border: 2px solid #e5e7eb;
        }

        .task-preview.past {
            opacity: 0.5;
        }

        .task-preview.current {
            border-color: #6366f1;
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.2);
        }

        .task-preview.future {
            opacity: 0.7;
        }

        .preview-time {
            font-size: 12px;
            color: #6366f1;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .preview-name {
            font-size: 16px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 8px;
        }

        .preview-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .preview-status.completed {
            background: #d1fae5;
            color: #065f46;
        }

        .preview-status.pending {
            background: #e0e7ff;
            color: #3730a3;
        }

        /* Swipe indicators */
        .swipe-indicators {
            display: flex;
            justify-content: center;
            gap: 6px;
            margin-top: 12px;
        }

        .indicator-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #d1d5db;
            transition: all 0.3s;
        }

        .indicator-dot.active {
            width: 24px;
            border-radius: 4px;
            background: #6366f1;
        }

        /* Responsibilities View */
        .responsibilities-view {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #f9fafb;
            z-index: 1500;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
            padding-top: 70px;
            padding-bottom: 80px;
        }

        .responsibilities-view.active {
            transform: translateX(0);
        }

        .responsibilities-content {
            padding: 16px;
        }

        .section-header {
            font-size: 18px;
            font-weight: 700;
            color: #111827;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-icon {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .responsibility-card {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .responsibility-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #f9fafb;
            border-radius: 12px;
            margin-bottom: 8px;
        }

        .task-checkbox {
            width: 24px;
            height: 24px;
            min-width: 24px;
            border: 2px solid #d1d5db;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .task-checkbox.checked {
            background: #10b981;
            border-color: #10b981;
        }

        .task-checkbox.checked::after {
            content: 'âœ“';
            color: white;
            font-size: 16px;
            font-weight: bold;
        }

        .completion-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 12px;
        }

        .completion-badge.complete {
            background: #d1fae5;
            color: #065f46;
        }

        .completion-badge.incomplete {
            background: #fef3c7;
            color: #78350f;
        }

        .character-category {
            margin-bottom: 16px;
        }

        .character-category-title {
            font-size: 15px;
            font-weight: 700;
            color: #374151;
            margin-bottom: 12px;
        }

        .character-trait-item {
            background: white;
            border-radius: 12px;
            padding: 14px;
            margin-bottom: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .character-trait-text {
            color: #374151;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .growth-rating {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .rating-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            background: white;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .rating-btn.active {
            border-color: #6366f1;
            background: #6366f1;
            color: white;
        }

        /* Wellness Journal View */
        .wellness-view {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #f9fafb;
            z-index: 1500;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            overflow-y: auto;
            padding-top: 70px;
            padding-bottom: 80px;
        }

        .wellness-view.active {
            transform: translateX(0);
        }

        .wellness-content {
            padding: 16px;
        }

        /* Tracker Selection */
        .tracker-selector {
            background: white;
            border-radius: 16px;
            padding: 16px;
            margin-bottom: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .tracker-option {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px;
            background: #f9fafb;
            border-radius: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tracker-option:hover {
            background: #f0f9ff;
            border: 2px solid #6366f1;
        }

        .tracker-icon {
            font-size: 32px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: white;
            border-radius: 12px;
        }

        .tracker-info {
            flex: 1;
        }

        .tracker-name {
            font-size: 15px;
            font-weight: 600;
            color: #111827;
            margin-bottom: 2px;
        }

        .tracker-entries {
            font-size: 12px;
            color: #6b7280;
        }

        .wellness-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
            margin-bottom: 12px;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            margin-bottom: 8px;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 16px;
            font-family: inherit;
        }

        .form-input:focus {
            outline: none;
            border-color: #6366f1;
        }

        textarea.form-input {
            min-height: 120px;
            resize: vertical;
        }

        .save-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #e5e7eb;
            display: flex;
            justify-content: space-around;
            padding: 12px 8px;
            z-index: 2000;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
        }

        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 8px 16px;
            background: none;
            border: none;
            color: #6b7280;
            font-size: 12px;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.2s;
        }

        .nav-btn.active {
            background: #f0f9ff;
            color: #6366f1;
        }

        .nav-icon {
            font-size: 24px;
        }

        .back-btn {
            padding: 8px 16px;
            background: #f9fafb;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
            cursor: pointer;
            margin-bottom: 16px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body>
    <!-- Top Navigation -->
    <div class="mobile-header">
        <svg class="app-logo" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <linearGradient id="compassGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#1e293b;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#0f172a;stop-opacity:1" />
                </linearGradient>
            </defs>
            <path d="M 50 5 A 45 45 0 1 0 50 95" 
                  fill="none" 
                  stroke="url(#compassGradient)" 
                  stroke-width="8" 
                  stroke-linecap="round"/>
            <circle cx="50" cy="50" r="20" fill="none" stroke="url(#compassGradient)" stroke-width="2" opacity="0.3"/>
            <path d="M 50 30 L 45 45 L 50 42 L 55 45 Z" 
                  fill="url(#compassGradient)"/>
            <path d="M 50 70 L 45 55 L 50 58 L 55 55 Z" 
                  fill="url(#compassGradient)" 
                  opacity="0.4"/>
            <line x1="70" y1="50" x2="65" y2="50" stroke="url(#compassGradient)" stroke-width="2" opacity="0.3"/>
            <line x1="30" y1="50" x2="35" y2="50" stroke="url(#compassGradient)" stroke-width="2" opacity="0.3"/>
            <circle cx="50" cy="50" r="3" fill="url(#compassGradient)"/>
        </svg>
        <div class="member-selector" onclick="toggleMemberDropdown()">
            <div class="member-avatar" id="current-avatar">ðŸ‘§</div>
            <div class="member-name" id="current-name">Sarah</div>
            <div class="dropdown-icon">â–¼</div>
        </div>
    </div>

    <!-- Member Dropdown -->
    <div class="member-dropdown" id="member-dropdown">
        <div class="member-option active" onclick="selectMember('sarah')">
            <div class="member-avatar">ðŸ‘§</div>
            <div>
                <div style="font-weight: 600;">Sarah</div>
                <div style="font-size: 12px; color: #6b7280;">2 of 17 tasks complete</div>
            </div>
        </div>
        <div class="member-option" onclick="selectMember('alex')">
            <div class="member-avatar">ðŸ‘¦</div>
            <div>
                <div style="font-weight: 600;">Alex</div>
                <div style="font-size: 12px; color: #6b7280;">5 of 17 tasks complete</div>
            </div>
        </div>
        <div class="member-option" onclick="selectMember('emma')">
            <div class="member-avatar">ðŸ‘¶</div>
            <div>
                <div style="font-weight: 600;">Emma</div>
                <div style="font-size: 12px; color: #6b7280;">1 of 12 tasks complete</div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="mobile-content">
        <!-- Routine View (Default) -->
        <div id="routine-view" class="routine-view active">
            <!-- Stats Cards - Swipeable -->
            <div class="stats-swipe-container">
                <div class="stats-track" id="stats-track">
                    <!-- Daily Progress -->
                    <div class="stat-card">
                        <div class="stat-label">Daily Progress</div>
                        <div class="stat-value">24%</div>
                        <div class="stat-subtext">4 of 17 tasks complete</div>
                    </div>
                    <!-- Weekly Progress -->
                    <div class="stat-card" style="background: linear-gradient(135deg, #f59e0b, #d97706);">
                        <div class="stat-label">Weekly Progress</div>
                        <div class="stat-value">67%</div>
                        <div class="stat-subtext">56 of 84 points this week</div>
                    </div>
                    <!-- Points Balance -->
                    <div class="stat-card" style="background: linear-gradient(135deg, #10b981, #059669);">
                        <div class="stat-label">Point Balance</div>
                        <div class="stat-value">342</div>
                        <div class="stat-subtext">+24 points today</div>
                    </div>
                </div>
                <div class="stat-indicators">
                    <div class="stat-dot active"></div>
                    <div class="stat-dot"></div>
                    <div class="stat-dot"></div>
                </div>
            </div>

            <!-- Current Task -->
            <div class="current-task-card">
                <div class="task-time">8:00 AM â€” Task 3 of 17</div>
                <div class="task-name">Morning Routine</div>
                
                <ul class="task-checklist">
                    <li>Brush teeth</li>
                    <li>Take vitamins/meds</li>
                    <li>Get dressed</li>
                    <li>Backpack ready</li>
                </ul>

                <button class="complete-task-btn" onclick="completeTask()">
                    âœ“ Mark Complete
                </button>
            </div>

            <!-- Timeline Preview -->
            <div style="margin-top: 24px;">
                <h3 style="font-size: 14px; color: #6b7280; margin-bottom: 12px; font-weight: 600;">SWIPE TO SEE OTHER TASKS</h3>
                <div class="swipe-container">
                    <div class="tasks-track" id="tasks-track">
                        <div class="task-preview past">
                            <div class="preview-time">7:00 AM</div>
                            <div class="preview-name">Wake-up time</div>
                            <span class="preview-status completed">âœ“ Completed</span>
                        </div>
                        <div class="task-preview past">
                            <div class="preview-time">7:15 AM</div>
                            <div class="preview-name">Breakfast time</div>
                            <span class="preview-status completed">âœ“ Completed</span>
                        </div>
                        <div class="task-preview current">
                            <div class="preview-time">7:40 AM</div>
                            <div class="preview-name">Morning routine</div>
                            <span class="preview-status pending">In Progress</span>
                        </div>
                        <div class="task-preview future">
                            <div class="preview-time">8:20 AM</div>
                            <div class="preview-name">School departure</div>
                            <span class="preview-status pending">Not Started</span>
                        </div>
                        <div class="task-preview future">
                            <div class="preview-time">4:00 PM</div>
                            <div class="preview-name">After school cool-down</div>
                            <span class="preview-status pending">Not Started</span>
                        </div>
                    </div>
                </div>
                <div class="swipe-indicators">
                    <div class="indicator-dot"></div>
                    <div class="indicator-dot"></div>
                    <div class="indicator-dot active"></div>
                    <div class="indicator-dot"></div>
                    <div class="indicator-dot"></div>
                </div>
            </div>
        </div>

        <!-- Responsibilities View -->
        <div id="responsibilities-view" class="responsibilities-view">
            <div class="responsibilities-content">
                <!-- Weekly Chores -->
                <div class="section-header">
                    <div class="section-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 6v6l4 2"/>
                        </svg>
                    </div>
                    Weekly Responsibilities
                </div>
                
                <div class="completion-badge incomplete">
                    4 / 6 Complete (67%) 
                </div>
                
                <div class="responsibility-card">
                    <div class="responsibility-item">
                        <div class="task-checkbox checked" onclick="toggleTaskCheck(this)"></div>
                        <span>Sweeping floors</span>
                    </div>
                    <div class="responsibility-item">
                        <div class="task-checkbox" onclick="toggleTaskCheck(this)"></div>
                        <span>Cleaning table</span>
                    </div>
                    <div class="responsibility-item">
                        <div class="task-checkbox checked" onclick="toggleTaskCheck(this)"></div>
                        <span>Cleaning bathrooms</span>
                    </div>
                    <div class="responsibility-item">
                        <div class="task-checkbox checked" onclick="toggleTaskCheck(this)"></div>
                        <span>Cleaning basement</span>
                    </div>
                    <div class="responsibility-item">
                        <div class="task-checkbox" onclick="toggleTaskCheck(this)"></div>
                        <span>Taking out garbage</span>
                    </div>
                    <div class="responsibility-item">
                        <div class="task-checkbox checked" onclick="toggleTaskCheck(this)"></div>
                        <span>Organizing shoe area</span>
                    </div>
                </div>

                <!-- Personal Growth -->
                <div class="section-header" style="margin-top: 24px;">
                    <div class="section-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                        </svg>
                    </div>
                    Personal Growth
                </div>
                
                <div class="character-category">
                    <div class="character-category-title">Conflict Resolution</div>
                    <div class="character-trait-item">
                        <div class="character-trait-text">Solving problems without escalating emotions</div>
                        <div class="growth-rating">
                            <button class="rating-btn" onclick="setRating(this, 1)">Starting</button>
                            <button class="rating-btn active" onclick="setRating(this, 2)">Progress</button>
                            <button class="rating-btn" onclick="setRating(this, 3)">Excelling</button>
                        </div>
                    </div>
                    <div class="character-trait-item">
                        <div class="character-trait-text">Apologizing and recognizing own part</div>
                        <div class="growth-rating">
                            <button class="rating-btn" onclick="setRating(this, 1)">Starting</button>
                            <button class="rating-btn" onclick="setRating(this, 2)">Progress</button>
                            <button class="rating-btn active" onclick="setRating(this, 3)">Excelling</button>
                        </div>
                    </div>
                </div>

                <div class="character-category">
                    <div class="character-category-title">Respect & Consideration</div>
                    <div class="character-trait-item">
                        <div class="character-trait-text">Asking and putting others first</div>
                        <div class="growth-rating">
                            <button class="rating-btn" onclick="setRating(this, 1)">Starting</button>
                            <button class="rating-btn active" onclick="setRating(this, 2)">Progress</button>
                            <button class="rating-btn" onclick="setRating(this, 3)">Excelling</button>
                        </div>
                    </div>
                    <div class="character-trait-item">
                        <div class="character-trait-text">Not interrupting when others speak</div>
                        <div class="growth-rating">
                            <button class="rating-btn" onclick="setRating(this, 1)">Starting</button>
                            <button class="rating-btn" onclick="setRating(this, 2)">Progress</button>
                            <button class="rating-btn active" onclick="setRating(this, 3)">Excelling</button>
                        </div>
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #f0fdf4, #dcfce7); padding: 12px; border-radius: 12px; border: 2px solid #86efac; margin-top: 16px;">
                    <div style="font-size: 11px; font-weight: 700; color: #166534; margin-bottom: 4px;">ðŸ’¡ Growth Multipliers</div> 
                    <div style="font-size: 10px; color: #166534; line-height: 1.4;">
                        <strong>Starting</strong> 1.0x Â· <strong>Progress</strong> 1.5x Â· <strong>Excelling</strong> 2.0x
                    </div>
                </div>
            </div>
        </div>

        <!-- Wellness Journal View - Tracker Selection -->
        <div id="wellness-view" class="wellness-view">
            <div class="wellness-content" id="wellness-tracker-selection">
                <div class="section-header">
                    <div class="section-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                        </svg>
                    </div>
                    Wellness Journals
                </div>
                
                <div class="tracker-selector">
                    <div class="tracker-option" onclick="openTracker('adhd')">
                        <div class="tracker-icon">ðŸ§ </div>
                        <div class="tracker-info">
                            <div class="tracker-name">ADHD Medication</div>
                            <div class="tracker-entries">12 entries Â· Last: Today</div>
                        </div>
                        <div style="color: #6b7280;">â€º</div>
                    </div>
                    <div class="tracker-option" onclick="openTracker('anxiety')">
                        <div class="tracker-icon">ðŸ˜°</div>
                        <div class="tracker-info">
                            <div class="tracker-name">Anxiety Management</div>
                            <div class="tracker-entries">8 entries Â· Last: Yesterday</div>
                        </div>
                        <div style="color: #6b7280;">â€º</div>
                    </div>
                </div>

                <div style="background: #f0f9ff; padding: 16px; border-radius: 12px; border: 2px solid #bae6fd;">
                    <div style="font-size: 12px; font-weight: 600; color: #0c4a6e; margin-bottom: 4px;">
                        ðŸ’¡ About Wellness Journals
                    </div>
                    <div style="font-size: 12px; color: #0369a1; line-height: 1.5;">
                        Track health conditions, medications, and progress over time. Select a journal to add an entry.
                    </div>
                </div>
            </div>

            <!-- Individual Tracker Entry View (hidden by default) -->
            <div class="wellness-content" id="wellness-tracker-entry" style="display: none;">
                <button class="back-btn" onclick="backToTrackerList()">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"/>
                    </svg>
                    Back to Journals
                </button>

                <div class="section-header">
                    <div class="section-icon">ðŸ§ </div>
                    <span id="tracker-title">ADHD Medication</span>
                </div>
                
                <div class="wellness-card">
                    <div class="form-group">
                        <label class="form-label">Date:</label>
                        <input type="date" class="form-input" id="wellness-date">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Observer Name:</label>
                        <input type="text" class="form-input" placeholder="Who is filling this out?">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Period/Phase:</label>
                        <select class="form-input">
                            <option>ðŸ“Š Baseline</option>
                            <option>ðŸ’Š Treatment</option>
                            <option>âœ… Maintenance</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Observer Ratings</label>
                        <p style="font-size: 12px; color: #6b7280; margin-bottom: 12px;">Rate observed behaviors (1=Poor, 5=Excellent)</p>
                        
                        <div style="background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                            <div style="font-weight: 600; font-size: 13px; margin-bottom: 8px;">Stays focused on tasks</div>
                            <div style="display: flex; gap: 8px;">
                                <button class="rating-btn" onclick="selectRating(this)">1</button>
                                <button class="rating-btn" onclick="selectRating(this)">2</button>
                                <button class="rating-btn active" onclick="selectRating(this)">3</button>
                                <button class="rating-btn" onclick="selectRating(this)">4</button>
                                <button class="rating-btn" onclick="selectRating(this)">5</button>
                            </div>
                        </div>

                        <div style="background: #f9fafb; padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                            <div style="font-weight: 600; font-size: 13px; margin-bottom: 8px;">Completes morning routine</div>
                            <div style="display: flex; gap: 8px;">
                                <button class="rating-btn" onclick="selectRating(this)">1</button>
                                <button class="rating-btn" onclick="selectRating(this)">2</button>
                                <button class="rating-btn" onclick="selectRating(this)">3</button>
                                <button class="rating-btn active" onclick="selectRating(this)">4</button>
                                <button class="rating-btn" onclick="selectRating(this)">5</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Notes:</label>
                        <textarea class="form-input" placeholder="Any additional observations or notes..."></textarea>
                    </div>

                    <button class="save-btn" onclick="saveWellness()">
                        ðŸ’¾ Save Entry
                    </button>
                </div>

                <div style="margin-top: 16px; padding: 16px; background: #f0f9ff; border-radius: 12px; border: 2px solid #bae6fd;">
                    <div style="font-size: 12px; font-weight: 600; color: #0c4a6e; margin-bottom: 8px;">
                        Recent Entries
                    </div>
                    <div style="font-size: 14px; color: #0369a1; line-height: 1.6;">
                        <div style="margin-bottom: 8px;">Today: Baseline phase Â· Avg rating 3.5</div>
                        <div>Yesterday: Treatment day Â· Avg rating 4.2</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav">
        <button class="nav-btn active" onclick="switchView('routine')">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                    <line x1="16" y1="2" x2="16" y2="6"/>
                    <line x1="8" y1="2" x2="8" y2="6"/>
                    <line x1="3" y1="10" x2="21" y2="10"/>
                </svg>
            </div>
            <div>Routine</div>
        </button>
        <button class="nav-btn" onclick="switchView('responsibilities')">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                </svg>
            </div>
            <div>Goals</div>
        </button>
        <button class="nav-btn" onclick="switchView('wellness')">
            <div class="nav-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                </svg>
            </div>
            <div>Wellness</div>
        </button>
    </div>

    <script>
        // ========================================
        // FIREBASE CONFIGURATION
        // ========================================
        const firebaseConfig = {
            apiKey: "AIzaSyCJzB673MruQvNpX_1wuGoHUFSk6leErFg",
            authDomain: "family-tracker-37025.firebaseapp.com",
            projectId: "family-tracker-37025",
            storageBucket: "family-tracker-37025.firebasestorage.app",
            messagingSenderId: "1004309710251",
            appId: "1:1004309710251:web:933164ffa6d5f78e6c7eee"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL);
        db.enablePersistence().catch((err) => console.log('Offline persistence:', err.code));

        let currentUser = null;
        let authInitialized = false;

        // ========================================
        // MOCK STATE MANAGER (simplified for demo)
        // ========================================
        const StateManager = {
            state: {
                currentChild: 'child1',
                currentDate: new Date().toISOString().split('T')[0],
                familyId: null,
                familyCode: null,
                children: ['child1', 'child2'],
                data: {
                    child1: {
                        name: 'Sarah',
                        photo: null,
                        colorPalette: 'purple',
                        pointsBalance: 342,
                        pointsSpent: 0,
                        trackers: [
                            { id: 'tracker1', templateName: 'ADHD Medication', templateId: 'adhd', icon: 'ðŸ§ ', entries: [] },
                            { id: 'tracker2', templateName: 'Anxiety Management', templateId: 'anxiety', icon: 'ðŸ˜°', entries: [] }
                        ],
                        days: {},
                        schedule: [],
                        weeklyChores: [
                            { id: 'sweep', name: 'Sweeping floors', completed: true },
                            { id: 'table', name: 'Cleaning table', completed: false },
                            { id: 'bathrooms', name: 'Cleaning bathrooms', completed: true },
                            { id: 'basement', name: 'Cleaning basement', completed: true },
                            { id: 'garbage', name: 'Taking out garbage', completed: false },
                            { id: 'shoes', name: 'Organizing shoe area', completed: true }
                        ]
                    },
                    child2: {
                        name: 'Alex',
                        photo: null,
                        colorPalette: 'blue',
                        pointsBalance: 278,
                        trackers: [],
                        days: {},
                        schedule: [],
                        weeklyChores: []
                    }
                }
            },
            getCurrentChild() {
                return this.state.data[this.state.currentChild];
            },
            getChild(childId) {
                return this.state.data[childId];
            }
        };

        window.StateManager = StateManager;

        // ========================================
        // FIREBASE DATA OPERATIONS
        // ========================================
        async function saveDataToFirebase() {
            if (!currentUser) return;
            
            try {
                console.log('ðŸ’¾ Saving data to Firebase...');
                const userId = currentUser.uid;
                
                if (StateManager.state.familyId) {
                    const familyRef = db.collection('families').doc(StateManager.state.familyId);
                    await familyRef.set({
                        children: StateManager.state.children,
                        lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                    }, { merge: true });
                    
                    for (const childId of StateManager.state.children) {
                        const memberData = StateManager.state.data[childId];
                        if (!memberData) continue;
                        
                        const { days, ...memberInfo } = memberData;
                        await familyRef.collection('familyMembers').doc(childId).set(memberInfo, { merge: true });
                        
                        for (const [date, dayData] of Object.entries(days || {})) {
                            await familyRef.collection('familyMembers').doc(childId)
                                .collection('days').doc(date).set(dayData, { merge: true });
                        }
                    }
                }
                
                console.log('âœ… Data saved');
            } catch (error) {
                console.error('âŒ Save error:', error);
            }
        }

        async function loadDataFromFirebase() {
            if (!currentUser) return;
            
            try {
                console.log('ðŸ“¥ Loading data from Firebase...');
                const userId = currentUser.uid;
                const userRef = db.collection('users').doc(userId);
                const userDoc = await userRef.get();
                
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    
                    if (userData.familyId) {
                        const familyRef = db.collection('families').doc(userData.familyId);
                        const familyDoc = await familyRef.get();
                        
                        if (familyDoc.exists) {
                            const familyData = familyDoc.data();
                            StateManager.state.children = familyData.children || ['child1', 'child2'];
                            StateManager.state.familyId = userData.familyId;
                            StateManager.state.familyCode = familyData.familyCode;
                            
                            for (const childId of StateManager.state.children) {
                                const memberDoc = await familyRef.collection('familyMembers').doc(childId).get();
                                if (memberDoc.exists) {
                                    StateManager.state.data[childId] = memberDoc.data();
                                    
                                    const daysSnapshot = await familyRef.collection('familyMembers').doc(childId)
                                        .collection('days').get();
                                    StateManager.state.data[childId].days = {};
                                    daysSnapshot.forEach(doc => {
                                        StateManager.state.data[childId].days[doc.id] = doc.data();
                                    });
                                }
                            }
                        }
                    }
                }
                
                console.log('âœ… Data loaded');
                updateUI();
                return true;
            } catch (error) {
                console.error('âŒ Load error:', error);
                return false;
            }
        }

        // ========================================
        // UI UPDATE FUNCTIONS
        // ========================================
        function updateUI() {
            const child = StateManager.getCurrentChild();
            if (!child) return;
            
            // Update member selector
            document.getElementById('current-name').textContent = child.name;
            
            // Update stats (simplified)
            const completedToday = 4;
            const totalToday = 17;
            const dailyPercent = Math.round((completedToday / totalToday) * 100);
            
            document.querySelector('.stat-value').textContent = dailyPercent + '%';
            document.querySelector('.stat-subtext').textContent = `${completedToday} of ${totalToday} tasks complete`;
            
            // Update points
            const pointsCard = document.querySelectorAll('.stat-card')[2];
            if (pointsCard) {
                pointsCard.querySelector('.stat-value').textContent = child.pointsBalance || 0;
            }
            
            // Update chores completion
            if (child.weeklyChores) {
                const completed = child.weeklyChores.filter(c => c.completed).length;
                const total = child.weeklyChores.length;
                const badge = document.querySelector('.completion-badge');
                if (badge) {
                    badge.textContent = `${completed} / ${total} Complete (${Math.round(completed/total*100)}%)`;
                    badge.className = completed === total ? 'completion-badge complete' : 'completion-badge incomplete';
                }
            }
            
            // Update wellness trackers
            updateWellnessTrackers();
        }

        function updateWellnessTrackers() {
            const child = StateManager.getCurrentChild();
            if (!child || !child.trackers || child.trackers.length === 0) {
                document.getElementById('wellness-tracker-selection').innerHTML = `
                    <div class="section-header">
                        <div class="section-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                            </svg>
                        </div>
                        Wellness Journals
                    </div>
                    <div style="background: #f0f9ff; padding: 16px; border-radius: 12px; border: 2px solid #bae6fd; text-align: center;">
                        <div style="font-size: 14px; color: #0369a1;">No wellness journals yet. Add one in the desktop app!</div>
                    </div>
                `;
                return;
            }
            
            const trackerHtml = child.trackers.map(tracker => {
                const entryCount = tracker.entries ? tracker.entries.length : 0;
                const lastEntry = entryCount > 0 ? 'Today' : 'Never';
                
                return `
                    <div class="tracker-option" onclick="openTracker('${tracker.id}')">
                        <div class="tracker-icon">${tracker.icon || 'ðŸ“Š'}</div>
                        <div class="tracker-info">
                            <div class="tracker-name">${tracker.templateName}</div>
                            <div class="tracker-entries">${entryCount} entries Â· Last: ${lastEntry}</div>
                        </div>
                        <div style="color: #6b7280;">â€º</div>
                    </div>
                `;
            }).join('');
            
            document.querySelector('.tracker-selector').innerHTML = trackerHtml;
        }

        // ========================================
        // AUTH STATE LISTENER
        // ========================================
        auth.onAuthStateChanged(async (user) => {
            if (user && !authInitialized) {
                authInitialized = true;
                currentUser = user;
                console.log('âœ… User signed in:', user.email);
                
                await loadDataFromFirebase();
                updateUI();
                
                // Hide login, show app
                document.body.innerHTML = document.body.innerHTML.replace('display: flex', 'display: none');
            } else if (!user) {
                authInitialized = false;
                currentUser = null;
                // Show login screen
            }
        });

        // Set today's date for wellness journal
        // Set today's date
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('wellness-date').value = today;

        // Stats card swiping
        let statsStartX = 0;
        let statsCurrentX = 0;
        let statsIsDragging = false;
        let currentStatIndex = 0;
        const statsTrack = document.getElementById('stats-track');
        const statCards = document.querySelectorAll('.stat-card');

        statsTrack.addEventListener('touchstart', (e) => {
            statsStartX = e.touches[0].clientX;
            statsIsDragging = true;
        });

        statsTrack.addEventListener('touchmove', (e) => {
            if (!statsIsDragging) return;
            statsCurrentX = e.touches[0].clientX;
            const diff = statsCurrentX - statsStartX;
            const currentOffset = -currentStatIndex * (window.innerWidth - 32);
            statsTrack.style.transform = `translateX(${currentOffset + diff}px)`;
        });

        statsTrack.addEventListener('touchend', () => {
            if (!statsIsDragging) return;
            statsIsDragging = false;
            
            const diff = statsCurrentX - statsStartX;
            if (Math.abs(diff) > 50) {
                if (diff > 0 && currentStatIndex > 0) {
                    currentStatIndex--;
                } else if (diff < 0 && currentStatIndex < statCards.length - 1) {
                    currentStatIndex++;
                }
            }
            
            const offset = -currentStatIndex * (window.innerWidth - 32);
            statsTrack.style.transform = `translateX(${offset}px)`;
            
            // Update indicators
            document.querySelectorAll('.stat-dot').forEach((dot, idx) => {
                dot.classList.toggle('active', idx === currentStatIndex);
            });
        });

        // Member dropdown
        function toggleMemberDropdown() {
            const dropdown = document.getElementById('member-dropdown');
            dropdown.classList.toggle('active');
        }

        function selectMember(member) {
            const childId = member === 'sarah' ? 'child1' : member === 'alex' ? 'child2' : 'child3';
            StateManager.state.currentChild = childId;
            
            const child = StateManager.getCurrentChild();
            if (child) {
                document.getElementById('current-name').textContent = child.name;
                updateUI();
            }
            
            // Update active state
            document.querySelectorAll('.member-option').forEach(opt => opt.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            toggleMemberDropdown();
            
            // Save selection
            saveDataToFirebase();
        }

        // Click outside to close dropdown
        document.addEventListener('click', (e) => {
            const dropdown = document.getElementById('member-dropdown');
            const selector = document.querySelector('.member-selector');
            if (!dropdown.contains(e.target) && !selector.contains(e.target)) {
                dropdown.classList.remove('active');
            }
        });

        // View switching
        function switchView(view) {
            const views = ['routine', 'responsibilities', 'wellness'];
            views.forEach(v => {
                const viewEl = document.getElementById(`${v}-view`);
                if (viewEl) viewEl.classList.remove('active');
            });
            document.getElementById(`${view}-view`).classList.add('active');

            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');

            // Show tracker selection when opening wellness
            if (view === 'wellness') {
                document.getElementById('wellness-tracker-selection').style.display = 'block';
                document.getElementById('wellness-tracker-entry').style.display = 'none';
            }
        }

        // Task completion
        function toggleTaskCheck(checkbox) {
            checkbox.classList.toggle('checked');
            
            // Update completion count
            const checked = document.querySelectorAll('.responsibility-card .task-checkbox.checked').length;
            const total = document.querySelectorAll('.responsibility-card .task-checkbox').length;
            const badge = document.querySelector('.completion-badge');
            const percent = Math.round((checked / total) * 100);
            badge.textContent = `${checked} / ${total} Complete (${percent}%)`;
            badge.className = checked === total ? 'completion-badge complete' : 'completion-badge incomplete';
            
            // Save to Firebase
            const child = StateManager.getCurrentChild();
            if (child && child.weeklyChores) {
                const choreIndex = Array.from(document.querySelectorAll('.responsibility-card .task-checkbox')).indexOf(checkbox);
                if (child.weeklyChores[choreIndex]) {
                    child.weeklyChores[choreIndex].completed = checkbox.classList.contains('checked');
                    saveDataToFirebase();
                }
            }
        }

        function completeTask() {
            const btn = event.currentTarget;
            btn.classList.add('completed');
            btn.textContent = 'âœ“ Completed!';
            
            // Update daily progress
            setTimeout(() => {
                // Increment task count (demo: 3 -> 4)
                const taskNum = document.querySelector('.task-time');
                taskNum.textContent = '8:20 AM â€” Task 4 of 17';
                
                // Update stats
                document.querySelector('.stat-value').textContent = '29%';
                document.querySelector('.stat-subtext').textContent = '5 of 17 tasks complete';
                
                // Move to next task
                document.querySelector('.task-name').textContent = 'School Departure';
                document.querySelector('.task-checklist').innerHTML = '<li>Leave on time</li>';
                
                btn.classList.remove('completed');
                btn.textContent = 'âœ“ Mark Complete';
                
                // Save completion to Firebase
                saveDataToFirebase();
            }, 1000);
        }

        // Swipe functionality for task timeline
        let startX = 0;
        let currentX = 0;
        let isDragging = false;
        const track = document.getElementById('tasks-track');

        track.addEventListener('touchstart', (e) => {
            startX = e.touches[0].clientX;
            isDragging = true;
        });

        track.addEventListener('touchmove', (e) => {
            if (!isDragging) return;
            currentX = e.touches[0].clientX;
            const diff = currentX - startX;
            track.style.transform = `translateX(${diff}px)`;
        });

        track.addEventListener('touchend', () => {
            isDragging = false;
            track.style.transform = 'translateX(0)';
        });

        // Growth ratings
        function setRating(btn, level) {
            const container = btn.parentElement;
            container.querySelectorAll('.rating-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            // Save rating to Firebase
            saveDataToFirebase();
        }

        // Wellness tracker selection
        function openTracker(trackerId) {
            document.getElementById('wellness-tracker-selection').style.display = 'none';
            document.getElementById('wellness-tracker-entry').style.display = 'block';
            
            const child = StateManager.getCurrentChild();
            if (!child || !child.trackers) return;
            
            const tracker = child.trackers.find(t => t.id === trackerId);
            if (tracker) {
                document.getElementById('tracker-title').textContent = tracker.templateName || 'Wellness Tracker';
            }
        }

        function backToTrackerList() {
            document.getElementById('wellness-tracker-selection').style.display = 'block';
            document.getElementById('wellness-tracker-entry').style.display = 'none';
        }

        function selectRating(btn) {
            const container = btn.parentElement;
            container.querySelectorAll('.rating-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function saveWellness() {
            // Collect form data
            const date = document.getElementById('wellness-date').value;
            const observer = document.querySelector('#wellness-tracker-entry input[type="text"]').value;
            const phase = document.querySelector('#wellness-tracker-entry select').value;
            const notes = document.querySelector('#wellness-tracker-entry textarea').value;
            
            // Collect ratings
            const ratings = {};
            document.querySelectorAll('#wellness-tracker-entry .rating-btn.active').forEach(btn => {
                const ratingGroup = btn.parentElement;
                const question = ratingGroup.previousElementSibling;
                if (question) {
                    ratings[question.textContent] = btn.textContent;
                }
            });
            
            const entry = {
                date,
                observer,
                phase,
                notes,
                ratings,
                timestamp: Date.now()
            };
            
            // Save to current tracker
            const child = StateManager.getCurrentChild();
            if (child && child.trackers) {
                // Find active tracker (simplified - would need to track which one is open)
                const tracker = child.trackers[0];
                if (tracker) {
                    if (!tracker.entries) tracker.entries = [];
                    tracker.entries.push(entry);
                    
                    saveDataToFirebase().then(() => {
                        alert('Wellness entry saved! âœ“');
                        setTimeout(() => {
                            backToTrackerList();
                        }, 500);
                    });
                }
            }
        }
    </script>
</body>
</html>
